const XLSX = require('xlsx')
const students = '[{"Temporal":"HQ5 S.A.S","Empresa":"HQ5 SAS","ID Periodo":35346,"Tipo de Perido":3,"Mes":10,"Numero de Contrato":"21976 - 398520","Nombres y Apellidos":"DAVIES  JAMES ANDREW JOHN","Numero de Identificación":398520,"Centro de Costo":"PLANTA","Dependencia":"GERENCIA GENERAL","Proceso":"INDIVIDUAL","Fecha Ingreso":1596326400000,"Fecha Retiro":null,"Cargo":"GERENTE DE PROYECTO Y CAMBIO ORGANIZACIONAL","Salario Base":3000000,"1 - Salario Ordinario / Unidades":240,"1 - Salario Ordinario / Neto":3000000,"100 - Hora Extra Diurna / Unidades":0,"100 - Hora Extra Diurna / Neto":0,"102 - Hora Extra Diurna Dominical / Festiva / Unidades":0,"102 - Hora Extra Diurna Dominical / Festiva / Neto":0,"120 - Subsidio de Transporte Legal / Unidades":0,"120 - Subsidio de Transporte Legal / Neto":0,"130 - Comisiones Estándar / Unidades":0,"130 - Comisiones Estándar / Neto":0,"15 - Incapacidad Enfermedad General Empresa 100% / Unidades":0,"15 - Incapacidad Enfermedad General Empresa 100% / Neto":0,"161 - Auxilio Movilidad / Unidades":0,"161 - Auxilio Movilidad / Neto":0,"162 - Auxilio de Alimentación / Unidades":0,"162 - Auxilio de Alimentación / Neto":0,"164 - Auxilio de Comunicación / Unidades":0,"164 - Auxilio de Comunicación / Neto":0,"165 - Auxilio de Conectividad / Unidades":0,"165 - Auxilio de Conectividad / Neto":0,"169 - Beneficio Óptico / Unidades":0,"169 - Beneficio Óptico / Neto":0,"17 - Incapacidad Enfermedad General EPS / Unidades":0,"17 - Incapacidad Enfermedad General EPS / Neto":0,"176 - Rodamiento / Unidades":0,"176 - Rodamiento / Neto":0,"181 - Bonificación Habitual Prestacional HQ5 / Unidades":0,"181 - Bonificación Habitual Prestacional HQ5 / Neto":0,"182 - Bonificación Habitual Prestacional turno adicional / Unidades":0,"182 - Bonificación Habitual Prestacional turno adicional / Neto":0,"186 - Remuneración variable / Unidades":0,"186 - Remuneración variable / Neto":0,"190 - Bonificación No Salarial / Unidades":0,"190 - Bonificación No Salarial / Neto":0,"191 - Bonificación No Salarial HQ5 / Unidades":0,"191 - Bonificación No Salarial HQ5 / Neto":0,"2 - Salario Integral / Unidades":0,"2 - Salario Integral / Neto":0,"20 - Incapacidad Maternidad / Unidades":0,"20 - Incapacidad Maternidad / Neto":0,"231 - Reintegro descuento autorizado / Unidades":0,"231 - Reintegro descuento autorizado / Neto":0,"27 - Licencia No Remunerada / Unidades":0,"27 - Licencia No Remunerada / Neto":0,"29 - Ausentismo injustificado / Unidades":0,"29 - Ausentismo injustificado / Neto":0,"3 - Apoyo Económico Aprendices / Unidades":0,"3 - Apoyo Económico Aprendices / Neto":0,"40 - Vacaciones en Tiempo / Unidades":0,"40 - Vacaciones en Tiempo / Neto":0,"41 - Vacaciones en Dinero / Unidades":0,"41 - Vacaciones en Dinero / Neto":0,"43 - Vacaciones en tiempo FDS / Unidades":0,"43 - Vacaciones en tiempo FDS / Neto":0,"50 - Incapacidad Enfermedad General EPS mes anterior / Unidades":0,"50 - Incapacidad Enfermedad General EPS mes anterior / Neto":0,"51 - Incapacidad Enfermedad General Empresa Mes anterior / Unidades":0,"51 - Incapacidad Enfermedad General Empresa Mes anterior / Neto":0,"Total Devengo":3000000,"122 - Descuento Subsidio de transporte legal mayor valor pagado / Unidades":0,"122 - Descuento Subsidio de transporte legal mayor valor pagado / Neto":0,"192 - Descuento mayor pagado bonificación no salarial / Unidades":0,"192 - Descuento mayor pagado bonificación no salarial / Neto":0,"200 - Descuento Autorizado / Unidades":0,"200 - Descuento Autorizado / Neto":0,"201 - Descuento Fincomercio / Unidades":0,"201 - Descuento Fincomercio / Neto":0,"206 - Descuento Grupo Recordar / Unidades":0,"206 - Descuento Grupo Recordar / Neto":0,"208 - Descuento Coorserpark / Unidades":0,"208 - Descuento Coorserpark / Neto":0,"225 - Descuento Préstamo Empresa Hq5 / Unidades":0,"225 - Descuento Préstamo Empresa Hq5 / Neto":0,"227 - Banco W ahorro / Unidades":0,"227 - Banco W ahorro / Neto":0,"230 - Descuento Anticipo de Salario y/o Liquidación / Unidades":0,"230 - Descuento Anticipo de Salario y/o Liquidación / Neto":0,"245 - Descuento autorizado CrediJob / Unidades":0,"245 - Descuento autorizado CrediJob / Neto":0,"250 - Descuento Autorizado Jornada de la Salud / Unidades":0,"250 - Descuento Autorizado Jornada de la Salud / Neto":0,"255 - Libranza Colsubsidio / Unidades":0,"255 - Libranza Colsubsidio / Neto":0,"302 - Embargo Cooperativas / Unidades":0,"302 - Embargo Cooperativas / Neto":0,"450 - Aporte Salud (EPS) Empleado / Unidades":240,"450 - Aporte Salud (EPS) Empleado / Neto":-120000,"451 - Aporte Pensión (AFP) Empleado / Unidades":240,"451 - Aporte Pensión (AFP) Empleado / Neto":-120000,"452 - Fondo Solidaridad Pensional Empleado / Unidades":0,"452 - Fondo Solidaridad Pensional Empleado / Neto":0,"453 - Retención en la Fuente / Unidades":0,"453 - Retención en la Fuente / Neto":0,"66 - Descuento Mayor valor pagado sin Seg Soc / Unidades":0,"66 - Descuento Mayor valor pagado sin Seg Soc / Neto":0,"Total Deduccion":-240000,"Neto A Pagar":2760000,"EPS":0,"AFP":360000,"ARL":15660,"Riesgo ARL":0.522,"CCF":125004,"SENA":0,"ICBF":0,"Total Seguridad Social":500664,"Vacaciones tiempo":125100,"Prima":249900,"Cesantías":249900,"Interés cesantías":30000,"Total provisiones":654900},{"Temporal":"HQ5 S.A.S","Empresa":"HQ5 SAS","ID Periodo":35346,"Tipo de Perido":3,"Mes":10,"Numero de Contrato":"15710 - 1156165","Nombres y Apellidos":"MIGDALIA TRINIDAD BLANCO DE RAMIREZ","Numero de Identificación":1156165,"Centro de Costo":"PLANTA","Dependencia":"DIRECCION DE COMPENSACION","Proceso":"COMPENSACION","Fecha Ingreso":1624492800000,"Fecha Retiro":null,"Cargo":"ANALISTA DE COMPENSACION","Salario Base":1600000,"1 - Salario Ordinario / Unidades":224,"1 - Salario Ordinario / Neto":1493333.33,"100 - Hora Extra Diurna / Unidades":0,"100 - Hora Extra Diurna / Neto":0,"102 - Hora Extra Diurna Dominical / Festiva / Unidades":0,"102 - Hora Extra Diurna Dominical / Festiva / Neto":0,"120 - Subsidio de Transporte Legal / Unidades":224,"120 - Subsidio de Transporte Legal / Neto":109360.53,"130 - Comisiones Estándar / Unidades":0,"130 - Comisiones Estándar / Neto":0,"15 - Incapacidad Enfermedad General Empresa 100% / Unidades":16,"15 - Incapacidad Enfermedad General Empresa 100% / Neto":134557.94,"161 - Auxilio Movilidad / Unidades":0,"161 - Auxilio Movilidad / Neto":0,"162 - Auxilio de Alimentación / Unidades":0,"162 - Auxilio de Alimentación / Neto":0,"164 - Auxilio de Comunicación / Unidades":0,"164 - Auxilio de Comunicación / Neto":0,"165 - Auxilio de Conectividad / Unidades":0,"165 - Auxilio de Conectividad / Neto":0,"169 - Beneficio Óptico / Unidades":0,"169 - Beneficio Óptico / Neto":0,"17 - Incapacidad Enfermedad General EPS / Unidades":0,"17 - Incapacidad Enfermedad General EPS / Neto":0,"176 - Rodamiento / Unidades":0,"176 - Rodamiento / Neto":0,"181 - Bonificación Habitual Prestacional HQ5 / Unidades":0,"181 - Bonificación Habitual Prestacional HQ5 / Neto":0,"182 - Bonificación Habitual Prestacional turno adicional / Unidades":0,"182 - Bonificación Habitual Prestacional turno adicional / Neto":0,"186 - Remuneración variable / Unidades":0,"186 - Remuneración variable / Neto":200000,"190 - Bonificación No Salarial / Unidades":0,"190 - Bonificación No Salarial / Neto":0,"191 - Bonificación No Salarial HQ5 / Unidades":0,"191 - Bonificación No Salarial HQ5 / Neto":0,"2 - Salario Integral / Unidades":0,"2 - Salario Integral / Neto":0,"20 - Incapacidad Maternidad / Unidades":0,"20 - Incapacidad Maternidad / Neto":0,"231 - Reintegro descuento autorizado / Unidades":0,"231 - Reintegro descuento autorizado / Neto":0,"27 - Licencia No Remunerada / Unidades":0,"27 - Licencia No Remunerada / Neto":0,"29 - Ausentismo injustificado / Unidades":0,"29 - Ausentismo injustificado / Neto":0,"3 - Apoyo Económico Aprendices / Unidades":0,"3 - Apoyo Económico Aprendices / Neto":0,"40 - Vacaciones en Tiempo / Unidades":0,"40 - Vacaciones en Tiempo / Neto":0,"41 - Vacaciones en Dinero / Unidades":0,"41 - Vacaciones en Dinero / Neto":0,"43 - Vacaciones en tiempo FDS / Unidades":0,"43 - Vacaciones en tiempo FDS / Neto":0,"50 - Incapacidad Enfermedad General EPS mes anterior / Unidades":0,"50 - Incapacidad Enfermedad General EPS mes anterior / Neto":0,"51 - Incapacidad Enfermedad General Empresa Mes anterior / Unidades":0,"51 - Incapacidad Enfermedad General Empresa Mes anterior / Neto":0,"Total Devengo":1937251.8,"122 - Descuento Subsidio de transporte legal mayor valor pagado / Unidades":0,"122 - Descuento Subsidio de transporte legal mayor valor pagado / Neto":0,"192 - Descuento mayor pagado bonificación no salarial / Unidades":0,"192 - Descuento mayor pagado bonificación no salarial / Neto":0,"200 - Descuento Autorizado / Unidades":0,"200 - Descuento Autorizado / Neto":0,"201 - Descuento Fincomercio / Unidades":0,"201 - Descuento Fincomercio / Neto":0,"206 - Descuento Grupo Recordar / Unidades":0,"206 - Descuento Grupo Recordar / Neto":0,"208 - Descuento Coorserpark / Unidades":0,"208 - Descuento Coorserpark / Neto":0,"225 - Descuento Préstamo Empresa Hq5 / Unidades":0,"225 - Descuento Préstamo Empresa Hq5 / Neto":0,"227 - Banco W ahorro / Unidades":0,"227 - Banco W ahorro / Neto":0,"230 - Descuento Anticipo de Salario y/o Liquidación / Unidades":0,"230 - Descuento Anticipo de Salario y/o Liquidación / Neto":-373333,"245 - Descuento autorizado CrediJob / Unidades":0,"245 - Descuento autorizado CrediJob / Neto":0,"250 - Descuento Autorizado Jornada de la Salud / Unidades":0,"250 - Descuento Autorizado Jornada de la Salud / Neto":-79850,"255 - Libranza Colsubsidio / Unidades":0,"255 - Libranza Colsubsidio / Neto":0,"302 - Embargo Cooperativas / Unidades":0,"302 - Embargo Cooperativas / Neto":0,"450 - Aporte Salud (EPS) Empleado / Unidades":240,"450 - Aporte Salud (EPS) Empleado / Neto":-73115,"451 - Aporte Pensión (AFP) Empleado / Unidades":0,"451 - Aporte Pensión (AFP) Empleado / Neto":0,"452 - Fondo Solidaridad Pensional Empleado / Unidades":0,"452 - Fondo Solidaridad Pensional Empleado / Neto":0,"453 - Retención en la Fuente / Unidades":0,"453 - Retención en la Fuente / Neto":0,"66 - Descuento Mayor valor pagado sin Seg Soc / Unidades":0,"66 - Descuento Mayor valor pagado sin Seg Soc / Neto":0,"Total Deduccion":-526298,"Neto A Pagar":1410953.8,"EPS":0,"AFP":0,"ARL":8839.2,"Riesgo ARL":0.522,"CCF":70782.26,"SENA":0,"ICBF":0,"Total Seguridad Social":79621.46,"Vacaciones tiempo":76223.07,"Prima":161373.07,"Cesantías":161373.07,"Interés cesantías":19372.52,"Total provisiones":418341.73}]'
const a = JSON.parse(students)
console.log(a)
// const convertJsonToExcel = () => {
//     const workSheet = XLSX.utils.json_to_sheet(students);
//     const workBook = XLSX.utils.book_new();
//     XLSX.utils.book_append_sheet(workBook, workSheet, "students")
//     // Generate buffer
//     XLSX.write(workBook, { bookType: 'xlsx', type: "buffer" })
//     // Binary string
//     XLSX.write(workBook, { bookType: "xlsx", type: "binary" })
//     XLSX.writeFile(workBook, "studentsData.xlsx")
// }
// convertJsonToExcel()